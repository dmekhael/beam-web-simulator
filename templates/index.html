<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Beam Bending Simulator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Beam Bending Simulator</h1>
        <form method="POST">
            <label>Beam Length (m):</label>
            <input type="number" name="length" step="any" required>

            <label>Load (N or Nm):</label>
            <input type="number" name="load" step="any" required>

            <label>Material:</label>
            <select name="E" required>
                <option value="200000000000">Steel (200 GPa)</option>
                <option value="70000000000">Aluminum (70 GPa)</option>
                <option value="116000000000">Titanium (116 GPa)</option>
            </select>

            <label>Moment of Inertia (m⁴):</label>
            <input type="number" name="I" step="any" required>

            <label>Load Type:</label>
            <select name="load_type" required>
                <option value="point" {% if selected_load == "point" %}selected{% endif %}>Point Load at Center</option>
                <option value="uniform" {% if selected_load == "uniform" %}selected{% endif %}>Uniformly Distributed Load</option>
                <option value="moment" {% if selected_load == "moment" %}selected{% endif %}>Cantilever with End Moment</option>
            </select>

            <button type="submit">Simulate</button>
        </form>

        {% if result %}
        <div class="output">
            <h2>Deflection Result:</h2>
            <p><strong>Maximum Deflection:</strong> {{ result }} m</p>
            <p><strong>Formula Used:</strong> {{ formula }}</p>
        </div>

        <div id="beam-diagram">
            <canvas id="beamCanvas" width="600" height="200" style="border: 1px solid #444; background: #111; margin-top: 20px;"></canvas>
        </div>
        <script>
            // Call JS function to draw the beam animation
            window.onload = function () {
                drawBeam("{{ load_type }}", {{ result }});
            };
        </script>
        {% endif %}

        {% if graph_url %}
        <div style="margin-top: 30px; text-align: center;">
            <img src="{{ url_for('static', filename=graph_url) }}" alt="Deflection Graph"
                 style="max-width: 100%; border-radius: 10px; box-shadow: 0 0 20px cyan;">
        </div>
        {% endif %}

        {% if explanation %}
        <div class="info-section" style="margin-top: 40px;">
            <h3>What’s Happening?</h3>
            <p>{{ explanation }}</p>
        </div>
        {% endif %}
    </div>

    <script src="{{ url_for('static', filename='beam_visuals.js') }}"></script>
</body>
</html>
